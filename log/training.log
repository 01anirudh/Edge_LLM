2025-07-06 06:31:11 - Edge_LLM - INFO - Namespace(model_name_or_path='huggyllama/llama-7b', trust_remote_code=False, use_auth_token=False, layer_num=32, eval_dataset_size=1024, max_train_samples=None, max_eval_samples=1000, source_max_len=1024, target_max_len=256, dataset='alpaca', dataset_format=None, output_dir='./output/edge_llm_llama_7b', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, eval_strategy=<IntervalStrategy.NO: 'no'>, prediction_loss_only=False, per_device_train_batch_size=1, per_device_eval_batch_size=1, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=16, eval_accumulation_steps=None, eval_delay=0, torch_empty_cache_steps=None, learning_rate=0.0004, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=0.3, num_train_epochs=3.0, max_steps=10000, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, lr_scheduler_kwargs={}, warmup_ratio=0.03, warmup_steps=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='./output/edge_llm_llama_7b/runs/Jul06_06-31-11_8b048e053ed5', logging_strategy=<IntervalStrategy.STEPS: 'steps'>, logging_first_step=False, logging_steps=10, logging_nan_inf_filter=True, save_strategy=<SaveStrategy.STEPS: 'steps'>, save_steps=1000, save_total_limit=40, save_safetensors=True, save_on_each_node=False, save_only_model=False, restore_callback_states_from_checkpoint=False, no_cuda=False, use_cpu=False, use_mps_device=False, seed=42, data_seed=None, jit_mode_eval=False, use_ipex=False, bf16=True, fp16=False, fp16_opt_level='O1', half_precision_backend='auto', bf16_full_eval=False, fp16_full_eval=False, tf32=None, local_rank=0, ddp_backend=None, tpu_num_cores=None, tpu_metrics_debug=False, debug=[], dataloader_drop_last=False, eval_steps=500.0, dataloader_num_workers=3, dataloader_prefetch_factor=None, past_index=-1, run_name='./output/edge_llm_llama_7b', disable_tqdm=False, remove_unused_columns=False, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=None, ignore_data_skip=False, fsdp=[], fsdp_min_num_params=0, fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}, fsdp_transformer_layer_cls_to_wrap=None, accelerator_config=AcceleratorConfig(split_batches=False, dispatch_batches=None, even_batches=True, use_seedable_sampler=True, non_blocking=False, gradient_accumulation_kwargs=None, use_configured_state=False), deepspeed=None, label_smoothing_factor=0.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, adafactor=False, group_by_length=True, length_column_name='length', report_to=['wandb'], ddp_find_unused_parameters=None, ddp_bucket_cap_mb=None, ddp_broadcast_buffers=None, dataloader_pin_memory=True, dataloader_persistent_workers=False, skip_memory_metrics=True, use_legacy_prediction_loop=False, push_to_hub=False, resume_from_checkpoint=None, hub_model_id=None, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, hub_private_repo=None, hub_always_push=False, hub_revision=None, gradient_checkpointing=False, gradient_checkpointing_kwargs=None, include_inputs_for_metrics=False, include_for_metrics=[], eval_do_concat_batches=True, fp16_backend='auto', push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, mp_parameters='', auto_find_batch_size=False, full_determinism=False, torchdynamo=None, ray_scope='last', ddp_timeout=1800, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, include_tokens_per_second=False, include_num_input_tokens_seen=False, neftune_noise_alpha=None, optim_target_modules=None, batch_eval_metrics=False, eval_on_start=False, use_liger_kernel=False, liger_kernel_config=None, eval_use_gather_object=False, average_tokens_across_devices=False, sortish_sampler=False, predict_with_generate=False, generation_max_length=None, generation_num_beams=None, generation_config=GenerationConfig {
  "max_new_tokens": 256
}
, cache_dir=None, train_on_source=False, mmlu_split='eval', mmlu_dataset='mmlu-fs', do_mmlu_eval=False, do_wikitext2_ppl=True, ppl_dataset='wikitext2', max_mmlu_samples=None, mmlu_source_max_len=1024, full_finetune=False, adam8bit=False, double_quant=True, quant_type='nf4', bits=4, lora_r=8, lora_alpha=16.0, lora_dropout=0.1, max_memory_MB=80000, log_dir='./log/', evaluation_strategy='steps', eval_batch_size=4, exploration=True, distributed_state=Distributed environment: DistributedType.NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, _n_gpu=1, __cached__setup_devices=device(type='cuda', index=0), deepspeed_plugin=None, qat=True, w_bits=4, a_bits=4, kv_bits=4, uniform_bits=8, layers_qats=None, layer_wise_qat=False, pruning=True, pruning_device='cuda', total_pruning_ratio=0.5, pruning_scheme='unstructure', num_pruning_samples=10, save_pruned_model=True, pruned_model_path='./pruning/pruned_models/', layer_wise_pruning=True, mse_file='./pruning/layer_wise_MSE_results/')
2025-07-06 06:31:11 - Edge_LLM - INFO - *****************BEGIN:loading model***************
2025-07-06 06:31:11 - Edge_LLM - INFO - {0: {'w': 8, 'a': 8, 'kv': 8}, 1: {'w': 8, 'a': 8, 'kv': 8}, 2: {'w': 4, 'a': 4, 'kv': 4}, 3: {'w': 8, 'a': 8, 'kv': 8}, 4: {'w': 8, 'a': 8, 'kv': 8}, 5: {'w': 8, 'a': 8, 'kv': 8}, 6: {'w': 8, 'a': 8, 'kv': 8}, 7: {'w': 8, 'a': 8, 'kv': 8}, 8: {'w': 8, 'a': 8, 'kv': 8}, 9: {'w': 8, 'a': 8, 'kv': 8}, 10: {'w': 8, 'a': 8, 'kv': 8}, 11: {'w': 8, 'a': 8, 'kv': 8}, 12: {'w': 8, 'a': 8, 'kv': 8}, 13: {'w': 8, 'a': 8, 'kv': 8}, 14: {'w': 8, 'a': 8, 'kv': 8}, 15: {'w': 8, 'a': 8, 'kv': 8}, 16: {'w': 8, 'a': 8, 'kv': 8}, 17: {'w': 8, 'a': 8, 'kv': 8}, 18: {'w': 8, 'a': 8, 'kv': 8}, 19: {'w': 8, 'a': 8, 'kv': 8}, 20: {'w': 8, 'a': 8, 'kv': 8}, 21: {'w': 8, 'a': 8, 'kv': 8}, 22: {'w': 8, 'a': 8, 'kv': 8}, 23: {'w': 8, 'a': 8, 'kv': 8}, 24: {'w': 8, 'a': 8, 'kv': 8}, 25: {'w': 8, 'a': 8, 'kv': 8}, 26: {'w': 8, 'a': 8, 'kv': 8}, 27: {'w': 8, 'a': 8, 'kv': 8}, 28: {'w': 8, 'a': 8, 'kv': 8}, 29: {'w': 4, 'a': 4, 'kv': 4}, 30: {'w': 4, 'a': 4, 'kv': 4}, 31: {'w': 4, 'a': 4, 'kv': 4}}
